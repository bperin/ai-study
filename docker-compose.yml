services:
    api:
        build:
            context: .
            dockerfile: packages/api/Dockerfile
        env_file: .env
        environment:
            DATABASE_URL: ${DATABASE_URL}
            JWT_SECRET: ${JWT_SECRET:-dev_secret}
            GOOGLE_APPLICATION_CREDENTIALS: /app/gcp-credentials.json
        ports:
            - "3000:3000"
        volumes:
            - ./gcp-credentials.json:/app/gcp-credentials.json

    web:
        build:
            context: .
            dockerfile: packages/web/Dockerfile
            args:
                NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL}
        env_file: .env
        ports:
            - "3001:3001"
        depends_on:
            - api
